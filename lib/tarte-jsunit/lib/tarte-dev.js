tarte="undefined"==typeof tarte?{}:tarte,module="undefined"==typeof module?{}:module,module.exports=tarte;tarte.dev={};tarte.dev.unit={};tarte.dev.unit.xenv={};tarte.dev.unit.xenv.node={};tarte.dev.unit.xenv.node.Ascii=function(){"use strict";function t(){var t="";this.toString=function(){return t},this.add=function(n){return t+=n,this},this.write=function(){return process.stdout.write(t),t="",this}}return t.prototype=tarte.dev.unit.xenv.node.Ascii.prototype,new t},tarte.dev.unit.xenv.node.Ascii.prototype=new function(){"use strict";function t(t){return"["+t}this.reset=function(){return this.add(t("0m"))},this.bold=function(){return this.add(t("1m"))},this.underline=function(){return this.add(t("4m"))},this.blink=function(){return this.add(t("5m"))},this.reverse=function(){return this.add(t("7m"))},this.conceal=function(){return this.add(t("8m"))},this.fg_black=function(){return this.add(t("30m"))},this.fg_red=function(){return this.add(t("31m"))},this.fg_green=function(){return this.add(t("32m"))},this.fg_yellow=function(){return this.add(t("33m"))},this.fg_blue=function(){return this.add(t("34m"))},this.fg_magenta=function(){return this.add(t("35m"))},this.fg_cyan=function(){return this.add(t("36m"))},this.fg_white=function(){return this.add(t("37m"))},this.bg_black=function(){return this.add(t("40m"))},this.bg_red=function(){return this.add(t("41m"))},this.bg_green=function(){return this.add(t("42m"))},this.bg_yellow=function(){return this.add(t("43m"))},this.bg_blue=function(){return this.add(t("44m"))},this.bg_magenta=function(){return this.add(t("45m"))},this.bg_cyan=function(){return this.add(t("46m"))},this.bg_white=function(){return this.add(t("47m"))},this.up=function(n){return this.add(t(n+"A"))},this.down=function(n){return this.add(t(n+"B"))},this.fore=function(n){return this.add(t(n+"C"))},this.back=function(n){return this.add(t(n+"D"))},this.move=function(n,i){return this.add(t(n+";"+i+"H"))},this.clear_screen=function(){return this.add(t("2J")).move(0,0)},this.clear_line=function(){return this.add(t("K"))}};var fs=require("fs"),path=require("path"),assert=require("assert");tarte.dev.unit.xenv.node.File=new function(){"use strict";function e(e,t){var r,n,o=!1;if("filepath"in e&&"string"==typeof e.filepath)r=e.filepath,n=0;else{var a=process.argv;e:for(n=0;n<t.length;n++)for(var i=t[n].getFileName(),s=0;s<a.length;s++)if("-"!==a[s].charAt(0))try{var f=path.resolve(a[s]);if(f===i){r=i;break e}}catch(l){}null==r&&(o=!0)}var u=-1,c=!1;if(null!=r)for(;n<t.length;n++){var p=t[n];if(r!==p.getFileName())break;p.isToplevel()?(u=p.getLineNumber(),c=!0):c||(u=p.getLineNumber())}else if(o){for(n=0;n<t.length&&!t[n].isEval();n++);for(;n<t.length;n++){var h=t[n];if(!h.isEval())break;h.isToplevel()?(u=h.getLineNumber(),c=!0):c||(u=h.getLineNumber())}}return u}function t(){var r=Error.prepareStackTrace;Error.prepareStackTrace=e;var n={};Error.captureStackTrace(n,t);var o=n.stack;return Error.prepareStackTrace=r,o}function r(e,t,n,o){fs.exists(e,function(a){a?fs.stat(e,function(a){null!=a||0===t.length?o(a):(e=path.join(e,t.shift()),r(e,t,n,o))}):fs.mkdir(e,n,function(a){null!=a||0===t.length?o(a):(e=path.join(e,t.shift()),r(e,t,n,o))})})}this.load=function(e,t,r,n){function o(e){if("function"==typeof l)l(e);else if("string"==typeof l)console.error(l);else{if(null!=l)throw new TypeError(l);console.error(e)}}function a(e,t){if("function"==typeof e)null==t?e():e(u);else if("string"==typeof e)console.log(e);else if(null!=e)throw new TypeError(e)}function i(){a(r.close,u)}function s(e){u=e,l=n.close}function f(){a(r.open),l=n.read}assert.equal(typeof e,"string","@param:path must be a string."),null==t&&(t={encoding:"utf8"}),null==r&&(r={}),null==n&&(n={}),assert.equal(typeof t,"object","@param:options must be an object."),assert.equal(typeof r,"object","@param:events must be an object."),assert.equal(typeof n,"object","@param:errors must be an object.");var l,u="";l=n.open;var c=fs.createReadStream(e,t);c.on("error",o),c.on("open",f),c.on("data",s),c.on("end",i)},this.save=function(e,t,r,n,o){function a(e){if("function"==typeof u)u(e);else if("string"==typeof u)console.error(u);else{if(null!=u)throw new TypeError(u);console.error(e)}}function i(e){if("function"==typeof e)e();else if("string"==typeof e)console.log(e);else if(null!=e)throw new TypeError(e)}function s(){i(n.close)}function f(){i(n.write),u=o.close,c.end()}function l(){i(n.open),u=o.write,c.write(t)&&f()}assert.equal(typeof e,"string","@param:path must be a string."),assert.equal(typeof t,"string","@param:text must be a string."),null==r&&(r={encoding:"utf8"}),null==n&&(n={}),null==o&&(o={}),assert.equal(typeof r,"object","@param:options must be an object."),assert.equal(typeof n,"object","@param:events must be an object."),assert.equal(typeof o,"object","@param:errors must be an object.");var u;u=o.open;var c=fs.createWriteStream(e,r);c.on("error",a),c.on("open",l),c.on("drain",f),c.on("finish",s)},this.getLineNumber=t,this.mkdirs=function(e,t,n){if(void 0===n&&"function"==typeof t&&(n=t,t=null),null==n)n=function(){};else if("function"!=typeof n)throw new TypeError("@param:cb is not a function.");var o=e.split(path.sep),a=o.shift();r(a,o,t,n)}};var path=require("path");tarte.dev.unit.xenv.node.Reporter=function(e){"use strict";function r(e){function r(){i(process.argv),u=n(h),console.log()}function n(e){var r=[e];return t(e,r),r}function t(e,r){for(var n=0;n<e.children.length;n++){var d=e.children[n];r.push(d),t(d,r)}}function d(){for(;u.length>0&&u[0].finished;){var e=u.shift();l(e)}0===u.length&&(s(),o())}function i(e){c=null;for(var r=2;r<e.length;r++){var n=e[r];if(null!=n&&"-"===n.charAt(0)){var t=n.split("=");switch(t[0]){case"--report-file":if(2!==t.length||t[1].length<1)throw new Error("!ERROR: The value of '--report-file' needs to be specified a file path.");c=t[1]}}}}function o(){null!=c&&f.File.mkdirs(path.dirname(c),function(e){if(e)throw e;f.File.save(c,JSON.stringify(a(h)))})}function a(e){for(var r=e.report(),n=[],t=0;t<e.children.length;t++)n.push(a(e.children[t]));return n.length>0&&(r.children=n),r}function l(e){for(var r=new f.Ascii,n=0;n<e.depth;n++)r.add("  ");e.checkCount>0&&(e.errorCount>0?r.fg_red().add("âœ•").reset().add(" "):r.fg_green().add("âœ“").reset().add(" ")),r.add(e.description),console.log(r.toString())}function s(){for(var e=n(h),r=0,t=0,d=[],i=0;i<e.length;i++){var o=e[i];if(o.errorCount>0){r++,t+=o.errorCount;for(var a=0;a<o.details.length;a++){var l=o.details[a];"okng"in l&&!l.okng&&d.push(l)}}}var s=new f.Ascii;if(s.add("\n  "),0===t)s.fg_green().add("All tests passed.").reset();else{s.fg_red().add(r).add(" tests (").add(t).add(" checks) errored").add("\n\n").add("== Error Checks ==").add("\n");for(var c=0;c<d.length;c++){var u=d[c];s.add("line:").add(u.line).add(" - type:").add(u.type).add(", desc.:").add(null==u.description?"":u.description).add("\n")}s.reset()}s.add("\n"),console.log(s.toString())}this.prepare=r,this.report=d;var f=tarte.dev.unit.xenv.node,c=null,h=e,u=[]}if(null==e)throw new Error("@param:rootTree is null.");var n=new r(e);return n};tarte.dev.unit.xenv.Async=function(r,n,t,e){"use strict";function o(r,n,t,e){function o(r){process.nextTick(r)}function i(r,n){setTimeout(r,l*n)}function a(r){if("number"!=typeof r)throw new TypeError("@param:num is not a number.");for(var t=[],e={},o={},i=0;r>i;i++)t[i]=i,e[t[i]]=!0;var a=Math.min(s,r),u=t.splice(0,a);"pre"in n&&n.pre();for(var c=0;a>c;c++)f(u[c],t,e,o,c)}function f(r,t,e,i,a){h(function(){try{p(r)}catch(a){i[r]=a,"error"in n&&n.error(a,r)}if(delete e[r],t.length>0){var u=t.shift();null!=u&&f(u,t,e,i,1)}0===Object.keys(e).length&&"post"in n&&o(function(){n.post(i)})},a)}function u(r){if(!Array.isArray(r))throw new TypeError("@param:arr is not an Array.");for(var t=[],e={},o={},i=0;i<r.length;i++)t[i]=i,e[t[i]]=!0;var a=Math.min(s,r.length),f=t.splice(0,a);"pre"in n&&n.pre(r);for(var u=0;a>u;u++)c(f[u],t,e,r,o,u)}function c(r,t,e,i,a,f){h(function(){var f=i[r];try{p(f,r)}catch(u){a[r]=u,"error"in n&&n.error(u,f,r)}if(delete e[r],t.length>0){var s=t.shift();null!=s&&c(s,t,e,i,a,1)}0===Object.keys(e).length&&"post"in n&&o(function(){n.post(i,a)})},f)}this.times=a,this.each=u;var p=r,s=t,l=e,h=10>l?o:i}if(null==n&&(n={}),null==t&&(t=Number.MAX_VALUE),null==e&&(e=0),"function"!=typeof r)throw new TypeError("@param:fn is not a function.");if("object"!=typeof n)throw new TypeError("@param:events is not an objext.");if("number"!=typeof t)throw new TypeError("@param:limit is not a number.");if("number"!=typeof e)throw new TypeError("@param:delay is not a number.");return new o(r,n,t,e)};tarte.dev.unit.xenv.TreeProxy=function(t){"use strict";function e(t,i){this.parent=t,this.id=this.generateId(t),this.description=i,this.depth=null!=t?t.depth+1:1,this.finished=!1,this.children=[],this.checkCount=0,this.errorCount=0,this.details=[],this.reporter=null!=t?t.reporter:new tarte.dev.unit.xenv.node.Reporter(this),this.newChild=function(t){var i=this,n=new e(i,t);return i.children.push(n),n}}return e.prototype=tarte.dev.unit.xenv.TreeProxy.prototype,new e(null,t)},tarte.dev.unit.xenv.TreeProxy.prototype=new function(){"use strict";var t=tarte.dev.unit.xenv.node.File,e=0;this.generateId=function(t){return null==t?"c"+e++:t.id+"_"+t.children.length},this.report=function(){var t=this,e={id:t.id,description:t.description};return t.details.length>0&&(e.checkCount=t.checkCount,e.errorCount=t.errorCount,e.details=t.details),e},this.prepare=function(){},this.finish=function(){null==this.parent&&this.reporter.prepare(),this.finished=!0,this.reporter.report()},this.clear=function(){var t=this;t.finished=!1,t.checkCount=0,t.errorCount=0,t.details=[]},this.note=function(t,e){this.details.push({type:t,description:e})},this.check=function(e,i,n,r,s,o){var h=this,u={type:e,description:i,okng:n,result:r,expect:s};null!=o&&(u.data=o),n||(h.errorCount++,u.line=t.getLineNumber()),h.checkCount++,h.details.push(u)}};tarte.dev.unit.TestTree=function(r){"use strict";function n(r){function t(r){if(r.checkCount>0)return!0;for(var n=0;n<r.children.length;n++)if(t(r.children[n]))return!0;return!1}function e(r){if(r.errorCount>0)return!0;for(var n=0;n<r.children.length;n++)if(e(r.children[n]))return!0;return!1}function i(r){for(var n=r.checkCount,t=0;t<r.children.length;t++)n+=i(r.children[t]);return n}function c(r){for(var n=r.errorCount,t=0;t<r.children.length;t++)n+=c(r.children[t]);return n}function u(r){r.clear();for(var n=0;n<r.children.length;n++)u(r.children[n])}function h(r,n){var t=[];if(n)o(r,v,t);else for(var e=0;e<v.children.length;e++){var i=v.children[e];t.push(r(i.src))}return t}function o(r,n,t){t.push(r(n.src));for(var e=0;e<n.children.length;e++){var i=n.children[e];o(r,i,t)}}function s(r,n){var t=[];if(n)l(r,v,t);else for(var e=0;e<v.children.length;e++){var i=v.children[e];r(i.src)&&t.push(i.src)}return t}function l(r,n,t){r(n.src)&&t.push(n.src);for(var e=0;e<n.children.length;e++){var i=n.children[e];l(r,i,t)}}function f(r,n){if(n)return a(r,v);for(var t=0;t<v.children.length;t++){var e=v.children[t];if(r(e.src))return e.src}return null}function a(r,n){if(r(n.src))return n.src;for(var t=null,e=0;e<n.children.length;e++){var i=n.children[e];if(null!=(t=a(r,i)))break}return t}function d(r,n,t,e){var i=h(function(r){return r},t),c={};null!=n&&("pre"in n&&(c.pre=function(){n.pre(v.src)}),"post"in n&&(c.post=function(r,t){n.post(v.src,t)}),"error"in n&&(c.error=function(r,t){n.error(r,t)}));var u=tarte.dev.unit.xenv.Async(r,c,e);u.each(i)}this.id=function(){return v.id},this.description=function(){return v.description},this.parent=function(){return null==v.parent?null:v.parent.src},this.newChild=function(r){return new n(v.newChild(r))},this.note=function(r,n){v.note(r,n)},this.check=function(r,n,t,e,i,c){v.check(r,n,t,e,i,c)},this.hasChecks=function(){return t(v)},this.hasErrors=function(){return e(v)},this.countChecks=function(){return i(v)},this.countErrors=function(){return c(v)},this.clear=function(){return u(v)},this.forEach=h,this.only=s,this.first=f,this.forEachAsync=d,this.setProcess=function(r){p=r,null!=p&&v.prepare(p)},this.hasProcess=function(){return null!=p},this.runProcess=function(){if(null!=p)try{tarte.dev.unit.TestProc.process(p),v.finish()}catch(r){throw p.check("ERROR",r.stack,!1),v.finish(),r}else v.finish()};var v=r;v.src=this;var p=null}return null==r&&(r=""),new n(tarte.dev.unit.xenv.TreeProxy(r))};tarte.dev.unit.TestProc=function(t,n){"use strict";function r(t,n){if(null!=t&&null!=n)for(var r in t)if(t.hasOwnProperty(r)){if(r in n)continue;n[r]=t[r]}}function e(t,n){null!=t&&("commons"in t&&r(t.commons,n),e(t.parent(),n))}function i(t){this.note=function(t,r){n.note(t,r)},this.check=function(t,r,e,i,o,f){n.check(t,r,e,i,o,f)};var n=t}if(null==n||"object"!=typeof n)throw new TypeError("@param:map needs to be an object.");i.prototype=tarte.dev.unit.TestProc.prototype;var o=new i(t);return r(n,o),e(t.parent(),o),t.setProcess(o),o},tarte.dev.unit.TestProc.prototype=new function(){"use strict";function t(t,n){if("string"==typeof t&&t===n)return{okng:!0,data:{same:t}};if(null==t||null==n||""===t||""===n)return{okng:!1,data:{same:"",difff1:t,diff2:n}};for(var r,e,i="",o=Math.min(t.length,n.length)+1,f=0;o>f&&(r=t.charAt(f),e=n.charAt(f),r===e);f++)i+=r;return{okng:!1,data:{same:i,diff1:r,diff2:e}}}function n(t,n,r){var e=[];if(n>=t)for(var i=t;n>=i;i+=r)e.push(i);else for(var o=t;o>=n;o-=r)e.push(o);return e[e.length-1]!==n&&e.push(n),e}function r(t,n,r){var e=[],i=t.charCodeAt(0),o=n.charCodeAt(0);if(o>=i)for(var f=i;o>=f;f+=r)e.push(String.fromCharCode(f));else for(var u=i;u>=o;u-=r)e.push(String.fromCharCode(u));return e[e.length-1]!==n&&e.push(n),e}function e(t){for(var n=[],r=0;r<t.length;r++)n.push(0);return n}function i(t,n,r){if(null==r)return[];for(var e=[],i=0;i<r.length;i++)e.push("function"==typeof n[i]?n[i].apply(t,e):n[i][r[i]]);for(var o=r.length-1;o>=0;o--)if("function"==typeof n[o]){if(0===o){r.splice(0,r.length);break}r[o]=0}else{if(!(r[o]>=n[o].length-1)){r[o]++;break}if(0===o){r.splice(0,r.length);break}r[o]=0}return e}function o(t,n,r){var e=typeof t;if("function"===e){var i=t();return typeof i===n?i:r}return e===n?t:r}function f(t,n,r,e){var i={post:e},o=tarte.dev.unit.xenv.Async(r,i,5,n);o.times(t)}this.message=function(t){this.note("MSG",t)},this.hbreak=function(){this.note("HBR")},this.pass=function(t){this.check("PASS",t,!0)},this.fail=function(t){this.check("FAIL",t,!1)},this.isTrue=function(t,n){this.check("TRUE",n,t===!0,t)},this.isFalse=function(t,n){this.check("FALSE",n,t===!1,t)},this.isNull=function(t,n){this.check("NULL",n,null==t,t)},this.equal=function(t,n,r){this.check("EQUAL",r,t===n,t,n)},this.match=function(n,r,e){var i=t(n,r);this.check("MATCH",e,i.okng,n,r,i.data)},this.seq=function(t,e,i){if(null==i)i=1;else{if("number"!=typeof i)throw new TypeError("@param:step is not a number.");i=Math.abs(i)}if("number"==typeof t){if("number"!=typeof e)throw new TypeError("@param:last is not a number.");return n(t,e,i)}if("string"==typeof t&&1===t.length){if("string"!=typeof e||1!==e.length)throw new TypeError("@param:last is not a character.");return r(t,e,i)}throw new TypeError("@param:start is not a number or a character.")},this.format=function(t){var n=Array.prototype.slice.call(arguments,1);return this.formatByArray(t,n)},this.formatByArray=function(t,n){function r(t){if("{0}"===t)return t;var r=n[t.slice(1,-1)-1];return"string"==typeof r?"'"+r+"'":r}null==n&&(n=[]);for(var e="",i=t.split("\\{"),o=0;o<i.length;o++)e+=i[o].replace(/\{[0-9]+\}/g,r);return e},this.matrix=function(t){if(!(arguments.length<2)){for(var n=[],r=1;r<arguments.length;r++){var o=arguments[r];if(null==o)throw new TypeError;if(Array.isArray(o))n.push(o);else{if("function"!=typeof o)throw new TypeError;n.push(o)}}for(var f=this,u=new function(){var t=e(n);this.hasNext=function(){return t.length>0},this.next=function(){return i(f,n,t)}};u.hasNext();)t.apply(this,u.next())}},this.showargs=function(){for(var t=Array.prototype.slice.call(arguments),n="",r=0;r<t.length;r++)n+=", "+this.format("{1}",t[r]);n.length>2&&(n=n.substring(2)),this.note("ARGS",n)},tarte.dev.unit.TestProc.process=function(t){var n=o(t.repeat,"number",1),r=o(t.multiple,"number",1),e=o(t.delay,"number",1);if("pre"in t&&"function"==typeof t.pre&&t.pre(),r>1){var i="run"in t&&"function"==typeof t.run?function(){for(var r=0;n>r;r++)t.run()}:function(){},u="post"in t&&"function"==typeof t.post?function(){t.post()}:function(){};f(r,e,i,u)}else{if("run"in t&&"function"==typeof t.run)for(var a=0;n>a;a++)t.run();"post"in t&&"function"==typeof t.post&&t.post()}}};tarte.dev.unit.TestScene=function(e,t){"use strict";function n(e,t){function n(e,t){var n=o.newChild(e);tarte.dev.unit.TestScene(n,t)}function c(e){null!=e&&"object"==typeof e&&(o.commons=e)}var o=e,r=new function(){this.scene=n,this.commons=c};t.call(r)}switch(typeof t){case"function":return new n(e,t);case"object":return tarte.dev.unit.TestProc(e,t);default:throw new TypeError("@param:fn needs to be either a function or an object.")}};tarte.dev.unit.TestCase=function(t,e){"use strict";return tarte.dev.unit.TestScene(t,e)};tarte.dev.unit.TestSuite=function(t,n){"use strict";function e(t,n){function e(t,n){var e=c.newChild(t);tarte.dev.unit.TestCase(e,n)}function o(t){null!=t&&"object"==typeof t&&(c.commons=t)}function i(t){c.forEachAsync(function(t){t.runProcess()},t,!0)}this.runTest=i;var c=t,r=new function(){this.testcase=e,this.commons=o};n.call(r)}if("function"!=typeof n)throw new TypeError("@param:fn needs to be a function.");return new e(tarte.dev.unit.TestTree(t),n)};